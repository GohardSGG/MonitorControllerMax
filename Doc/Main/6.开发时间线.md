# 6. 开发路线图 (Roadmap) - 更新于 2025.12.09

本路线图以**里程碑**为导向。

---

## ✅ 阶段一：GUI 基础设施构建与样式定稿 (已完成)

**已交付成果**:
- 1. **基础设施**：`wgpu` 后端，DPI 缩放 (`set_scale_factor_override`)。
- 2. **视觉风格**：Brutalist 组件库，响应式布局。
- 3. **复杂布局**：Header, Sidebar, Matrix, Log Panel。
- 4. **构建流程**：`xtask` 修复。

---

## ✅ 阶段二：核心逻辑与网络层实现 (已完成)

**目标**: 实现 v4.0 规范的核心逻辑，并打通基于 ZMQ 的分布式通信。

**已交付成果**:
- [x] **Params 定义**: `MonitorParams` 完整实现 (Cut/Dim/Volume/通道状态)
- [x] **Logic 实现**: `ChannelLogic::compute()` 纯函数计算 `RenderState`
- [x] **网络层开发**: ZeroMQ PUB/SUB (端口 9123) + Bincode 序列化
- [x] **Slave 状态机**: `AtomicCell` 无锁缓存读取
- [x] **数据结构**: `RenderState` + `NetworkRenderState` (magic: 0x4D43)

---

## ✅ 阶段三：UI 功能绑定与交互实现 (已完成)

**目标**: 将 GUI 按钮与逻辑核心对接。

**已交付成果**:
- [x] **交互状态机**: `InteractionManager` v4.0 完整实现
  - PrimaryMode (None/Solo/Mute) + CompareMode (None/Solo/Mute)
  - 自动反转逻辑 (copy_set)
  - 记忆标记 (solo_has_memory/mute_has_memory)
- [x] **通道集合**: `ChannelSet` 基于 HashSet<String> 存储通道名
- [x] **GUI 绑定**: Solo/Mute/Cut/Dim/Volume 按钮完整联动
- [x] **视觉反馈**:
  - 常亮 (Primary模式) / 闪烁 (Compare模式)
  - Solo=绿色, Mute=红色, Idle=灰色
- [x] **SUB 特殊逻辑**: 豁免权 + User Mute (双击强制静音)

---

## ✅ 阶段四：硬件集成 (已完成)

**目标**: OSC 硬件联动。

**已交付成果**:
- [x] **OSC 通信**: 双向收发 (端口 9124)
- [x] **Loupedeck 集成**: C# 插件 `MonitorOSCPlugin`
- [x] **模式控制**: `/Monitor/Mode/Solo`, `/Monitor/Mode/Mute`
- [x] **通道控制**: `/Monitor/Channel/{name}` (0=Off, 1=Mute, 2=Solo)
- [x] **语义层扩展**: value=10 (有声音), value=11 (增量移除), value=12 (可退出移除)
- [x] **闪烁定时器**: Compare 模式下的视觉同步
- [x] **Cut 双向同步**: GUI ↔ 硬件状态一致

---

## ➡️ 阶段五：测试验证与打磨 (当前阶段)

**目标**: 验证音频处理正确性，确保 Master-Slave 通信稳定。

**核心任务**:
- [ ] **音频验证**: Solo/Mute/Cut/Dim/Volume 是否真正作用于音频
- [ ] **本机测试**: 同一 DAW 内 Master + Slave 状态同步
- [ ] **跨实例测试**: 两个 DAW 实例间的通信
- [ ] **断连测试**: Master 关闭时 Slave 的行为 (状态保持/平滑静音)
- [ ] **增益平滑**: 如有点击噪声，添加 ramping

**验收标准 (里程碑 M1 - Production Ready)**:
- 所有控制功能实际作用于音频输出
- Master-Slave 实时同步，延迟 <5ms
- 断连时 Slave 保持最后状态，无爆音

---

## 🕒 阶段六：文档完善与发布

**目标**: 发布 v5.0 (Rust Edition)。

**待办**:
- [ ] 用户手册编写
- [ ] 安装/部署指南
- [ ] 版本打包与发布
